# <a name="word--javascript-redact-add-in"></a>Надстройка JavaScript для исправления текста в Word

Узнайте, как создать надстройку для поиска, выделения и исправления текста.    

## <a name="table-of-contents"></a>Содержание
* [История изменений](#change-history)
* [Важное примечание](#important-note)
* [Необходимые компоненты](#prerequisites)
* [Настройка проекта](#configure-the-project)
* [Запуск проекта](#run-the-project)
* [Вопросы и комментарии](#questions-and-comments)
* [Дополнительные ресурсы](#additional-resources)

## <a name="change-history"></a>История изменений

25 июля 2016 г.
* Создание исходной версии примера.

## <a name="important-note"></a>Важно!

В этом примере каждая буква в тексте заменяется звездочкой.  Макет не сохраняется.  Шрифт, размер и форматирование букв не определяются.

## <a name="prerequisites"></a>Предварительные условия

* Word 2016 для Windows, сборка 16.0.6912.1000 или более поздняя.
* [Node и npm](https://nodejs.org/en/)
* [Git Bash](https://git-scm.com/downloads). Используйте последнюю сборку, так как в более ранних сборках может возникать ошибка при создании сертификатов.

## <a name="configure-the-project"></a>Настройка проекта

Выполните приведенные ниже команды из консоли Bash в корне проекта:

1. Клонируйте этот репозиторий на локальный компьютер.
2. ```npm install``` — для установки всех зависимостей в package.json.
3. ```bash gen-cert.sh``` — для создания сертификатов, необходимых для запуска этого примера. 
* В репозитории на локальном компьютере дважды щелкните файл ca.crt и выберите элемент **Установить сертификат**. 
* Выберите **Локальный компьютер** и нажмите кнопку **Далее**, чтобы продолжить. 
* Выберите **Поместить все сертификаты в следующее хранилище** и нажмите кнопку **Обзор**.  
* Выберите **Доверенные корневые центры сертификации** и нажмите кнопку **ОК**. 
* Нажмите кнопку **Далее**, а затем кнопку **Готово**. Теперь сертификат из центра сертификации добавлен в хранилище сертификатов.
4. ```npm start``` — для запуска службы веб-сервера узла.

Теперь необходимо сообщить Microsoft Word, где находится эта надстройка.

1. Создайте сетевую папку или [откройте доступ к папке в сети](https://technet.microsoft.com/ru-ru/library/cc770880.aspx) и поместите в нее файл манифеста [word-add-in-javascript-speckit-manifest.xml](word-add-in-javascript-speckit-manifest.xml).
3. Запустите Word и откройте документ.
4. Перейдите на вкладку **Файл**, а затем выберите **Параметры**.
5. Выберите **Центр управления безопасностью**, а затем нажмите кнопку **Параметры центра управления безопасностью**.
6. Выберите пункт **Доверенные каталоги надстроек**.
7. В поле **URL-адрес каталога** введите сетевой путь к общей папке с файлом word-add-in-js-redact-manifest.xml и выберите **Добавить каталог**.
8. Установите флажок **Показать в меню** и нажмите кнопку **ОК**.
9. Появится сообщение о том, что параметры будут применены при следующем запуске Microsoft Office. Закройте и перезапустите Word.

## <a name="run-the-project"></a>Запуск проекта

1. Откройте документ Word.
2. На вкладке **Вставка** в Word 2016 выберите **Мои надстройки**.
3. Откройте вкладку **ОБЩАЯ ПАПКА**.
4. Выберите **надстройку Word Redact** и нажмите кнопку **ОК**.
5. Если ваша версия Word поддерживает команды надстроек, то в пользовательском интерфейсе отобразятся сведения о том, что надстройка загружена.

### <a name="ribbon-ui"></a>Интерфейс пользователя на основе ленты

На ленте:
* Перейдите на вкладку **Рецензирование** и выберите пункт **Show Redaction Task Pane**, чтобы открыть область задач.

 > Примечание. Если ваша версия Word не поддерживает команды надстроек, то надстройка загрузится в области задач.

### <a name="task-pane-ui"></a>Пользовательский интерфейс области задач

В области задач вы можете:
* Чтобы найти и выделить текст в документе, введите слово в текстовое поле и нажмите кнопку **Search and Highlight** (Поиск и выделение).
  
> ПРИМЕЧАНИЕ.  При поиске учитывается регистр.  Чтобы отменить действие, нажмите клавиши Ctrl + Z на клавиатуре.

* Чтобы исправить текст в документе, введите слово в текстовое поле и нажмите кнопку **Redact** (Редактировать).
  
> ПРИМЕЧАНИЕ.  При исправлении регистр не учитывается.   

* Чтобы исправить выделенный текст в документе, нажмите кнопку **Redact selected text** (Редактировать выделенный текст).
  
> ПРИМЕЧАНИЕ.  При исправлении регистр не учитывается.       
  
### <a name="add-in-commands"></a>Команды надстроек

В этом примере показано, как создавать команды надстроек на ленте. Описания команд надстроек находятся в файле word-add-in-js-redact-manifest.xml. 

## <a name="questions-and-comments"></a>Вопросы и комментарии

Поделитесь с нами своим мнением о примере Word Redact. Вы можете отправлять отзывы в разделе *Issues* этого репозитория.

Общие вопросы о разработке решений для Microsoft Office 365 следует публиковать на сайте [Stack Overflow](http://stackoverflow.com/questions/tagged/office-js+API). Помечайте свои вопросы тегами [office-js] и [API].

## <a name="additional-resources"></a>Дополнительные ресурсы

* [Документация по надстройкам Office](https://msdn.microsoft.com/ru-ru/library/office/jj220060.aspx)
* [Центр разработки для Office](http://dev.office.com/)
* [Проекты API Office 365 и примеры кода для начинающих](http://msdn.microsoft.com/ru-ru/office/office365/howto/starter-projects-and-code-samples)

## <a name="copyright"></a>Авторское право
© Корпорация Майкрософт (Microsoft Corporation), 2016 г. Все права защищены.



Этот проект соответствует [правилам поведения Майкрософт, касающимся обращения с открытым кодом](https://opensource.microsoft.com/codeofconduct/). Дополнительную информацию см. в разделе [часто задаваемых вопросов по правилам поведения](https://opensource.microsoft.com/codeofconduct/faq/). Если у вас возникли вопросы или замечания, напишите нам по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).
